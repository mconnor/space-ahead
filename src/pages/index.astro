---
import { getCollection } from "astro:content";
import MainLayout from "#layouts/MainLayout.astro";
import siteConfig from "#site.config.ts";
import { sortItemsByDateDesc, withBase } from "#utils/helpers.ts";
import PostCardPreview from "#components/PostCardPreview.astro";
import Button from "#components/Button.astro";
import { Image } from "astro:assets";
import heroImage from "#assets/images/pixeltrue-space-discovery.svg";
import ArrowRight from "#icons/ArrowRight.astro";

const allPosts = (await getCollection("blogs")).sort(sortItemsByDateDesc);
---

<MainLayout
  activePage="home"
  pageTitle={siteConfig.title + " | An Astro Personal Blog Template"}
>
  <div
    class="jumbo-banner my-12 flex w-full flex-col gap-6 px-4 sm:flex-row sm:items-center sm:justify-between"
  >
    <div class="w-full sm:w-fit sm:max-w-1/2">
      {
        siteConfig.hero?.eyebrowText && (
          <span class="tag kanit-light rounded-full border border-gray-500 px-2 py-0 text-xs">
            {siteConfig.hero?.eyebrowText}
          </span>
        )
      }
      <h1 class="sigmar-ff leading-tight text-balance sm:pt-0!">
        {siteConfig.hero?.title}
      </h1>
      <p class="kanit-regular text-xs text-balance sm:text-base">
        {siteConfig.hero?.text}
      </p>
      <div
        class="mt-3 flex flex-wrap items-center gap-x-2 gap-y-8 text-xs sm:mt-12 sm:text-base"
      >
        {
          siteConfig.hero?.actions?.map((action, index) => (
            <Button
              href={action.href}
              class={index === 0 ? "space-btn-filled" : "space-btn-outlined"}
            >
              {action.text}
            </Button>
          ))
        }
      </div>
    </div>
    <div class="w-full sm:w-fit sm:max-w-1/2">
      <!-- {siteConfig.hero?.image && <Image src={siteConfig.hero?.image?.src} alt={siteConfig.hero?.image?.alt || ""} inferSize={true} />} -->
      <Image
        class="cover-img"
        src={heroImage}
        alt={"Astronaut in space"}
        width={400}
        height={300}
      />
    </div>
  </div>
  <div class="page-content">
    <div id="posts" class="flex w-full flex-col items-center justify-center">
      <h2 class="sigmar-ff pt-0! pb-8! text-balance">Recent Stories</h2>
      <div class="flex max-w-full flex-col gap-8 text-left">
        {
          allPosts
            .slice(0, siteConfig.recentPostLimit)
            .map((post) => <PostCardPreview post={post} />)
        }
      </div>
      <Button href={withBase("/blog")} class="space-btn-filled mt-8">
        View All Posts <ArrowRight class="ml-4 h-5 w-5 fill-current" />
      </Button>
    </div>
  </div>
</MainLayout>
